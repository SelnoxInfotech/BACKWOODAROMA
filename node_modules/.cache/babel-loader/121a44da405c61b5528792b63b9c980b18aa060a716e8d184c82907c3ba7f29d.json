{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport updateMutation from './util/updateMutation';\nimport rangeSort from './util/rangeSort';\nimport getElementHTML from './util/getElementHTML';\nimport getElementTagLength from './util/getElementTagLength';\nvar converter = function converter() {\n  var entity = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var originalText = arguments.length > 1 ? arguments[1] : undefined;\n  return originalText;\n};\nexport default (function (block, entityMap) {\n  var entityConverter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : converter;\n  var resultText = _toConsumableArray(block.text);\n  var getEntityHTML = entityConverter;\n  if (entityConverter.__isMiddleware) {\n    getEntityHTML = entityConverter(converter);\n  }\n  if (Object.prototype.hasOwnProperty.call(block, 'entityRanges') && block.entityRanges.length > 0) {\n    var entities = block.entityRanges.sort(rangeSort);\n    var styles = block.inlineStyleRanges;\n    var _loop = function _loop(index) {\n      var entityRange = entities[index];\n      var entity = entityMap[entityRange.key];\n      var originalText = resultText.slice(entityRange.offset, entityRange.offset + entityRange.length).join('');\n      var entityHTML = getEntityHTML(entity, originalText);\n      var elementHTML = getElementHTML(entityHTML, originalText);\n      var converted = void 0;\n      if (!!elementHTML || elementHTML === '') {\n        converted = _toConsumableArray(elementHTML);\n      } else {\n        converted = originalText;\n      }\n      var prefixLength = getElementTagLength(entityHTML, 'start');\n      var suffixLength = getElementTagLength(entityHTML, 'end');\n      var updateLaterMutation = function updateLaterMutation(mutation, mutationIndex) {\n        if (mutationIndex > index || Object.prototype.hasOwnProperty.call(mutation, 'style')) {\n          return updateMutation(mutation, entityRange.offset, entityRange.length, converted.length, prefixLength, suffixLength);\n        }\n        return mutation;\n      };\n      var updateLaterMutations = function updateLaterMutations(mutationList) {\n        return mutationList.reduce(function (acc, mutation, mutationIndex) {\n          var updatedMutation = updateLaterMutation(mutation, mutationIndex);\n          if (Array.isArray(updatedMutation)) {\n            return acc.concat(updatedMutation);\n          }\n          return acc.concat([updatedMutation]);\n        }, []);\n      };\n      entities = updateLaterMutations(entities);\n      styles = updateLaterMutations(styles);\n      resultText = [].concat(_toConsumableArray(resultText.slice(0, entityRange.offset)), _toConsumableArray(converted), _toConsumableArray(resultText.slice(entityRange.offset + entityRange.length)));\n    };\n    for (var index = 0; index < entities.length; index++) {\n      _loop(index);\n    }\n    return Object.assign({}, block, {\n      text: resultText.join(''),\n      inlineStyleRanges: styles,\n      entityRanges: entities\n    });\n  }\n  return block;\n});","map":{"version":3,"names":["_toConsumableArray","updateMutation","rangeSort","getElementHTML","getElementTagLength","converter","entity","arguments","length","undefined","originalText","block","entityMap","entityConverter","resultText","text","getEntityHTML","__isMiddleware","Object","prototype","hasOwnProperty","call","entityRanges","entities","sort","styles","inlineStyleRanges","_loop","index","entityRange","key","slice","offset","join","entityHTML","elementHTML","converted","prefixLength","suffixLength","updateLaterMutation","mutation","mutationIndex","updateLaterMutations","mutationList","reduce","acc","updatedMutation","Array","isArray","concat","assign"],"sources":["/workspaces/Backwoodaroma/node_modules/draft-convert/esm/blockEntities.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport updateMutation from './util/updateMutation';\nimport rangeSort from './util/rangeSort';\nimport getElementHTML from './util/getElementHTML';\nimport getElementTagLength from './util/getElementTagLength';\n\nvar converter = function converter() {\n  var entity = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var originalText = arguments.length > 1 ? arguments[1] : undefined;\n  return originalText;\n};\n\nexport default (function (block, entityMap) {\n  var entityConverter = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : converter;\n\n  var resultText = _toConsumableArray(block.text);\n\n  var getEntityHTML = entityConverter;\n\n  if (entityConverter.__isMiddleware) {\n    getEntityHTML = entityConverter(converter);\n  }\n\n  if (Object.prototype.hasOwnProperty.call(block, 'entityRanges') && block.entityRanges.length > 0) {\n    var entities = block.entityRanges.sort(rangeSort);\n    var styles = block.inlineStyleRanges;\n\n    var _loop = function _loop(index) {\n      var entityRange = entities[index];\n      var entity = entityMap[entityRange.key];\n      var originalText = resultText.slice(entityRange.offset, entityRange.offset + entityRange.length).join('');\n      var entityHTML = getEntityHTML(entity, originalText);\n      var elementHTML = getElementHTML(entityHTML, originalText);\n      var converted = void 0;\n\n      if (!!elementHTML || elementHTML === '') {\n        converted = _toConsumableArray(elementHTML);\n      } else {\n        converted = originalText;\n      }\n\n      var prefixLength = getElementTagLength(entityHTML, 'start');\n      var suffixLength = getElementTagLength(entityHTML, 'end');\n\n      var updateLaterMutation = function updateLaterMutation(mutation, mutationIndex) {\n        if (mutationIndex > index || Object.prototype.hasOwnProperty.call(mutation, 'style')) {\n          return updateMutation(mutation, entityRange.offset, entityRange.length, converted.length, prefixLength, suffixLength);\n        }\n\n        return mutation;\n      };\n\n      var updateLaterMutations = function updateLaterMutations(mutationList) {\n        return mutationList.reduce(function (acc, mutation, mutationIndex) {\n          var updatedMutation = updateLaterMutation(mutation, mutationIndex);\n\n          if (Array.isArray(updatedMutation)) {\n            return acc.concat(updatedMutation);\n          }\n\n          return acc.concat([updatedMutation]);\n        }, []);\n      };\n\n      entities = updateLaterMutations(entities);\n      styles = updateLaterMutations(styles);\n      resultText = [].concat(_toConsumableArray(resultText.slice(0, entityRange.offset)), _toConsumableArray(converted), _toConsumableArray(resultText.slice(entityRange.offset + entityRange.length)));\n    };\n\n    for (var index = 0; index < entities.length; index++) {\n      _loop(index);\n    }\n\n    return Object.assign({}, block, {\n      text: resultText.join(''),\n      inlineStyleRanges: styles,\n      entityRanges: entities\n    });\n  }\n\n  return block;\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}