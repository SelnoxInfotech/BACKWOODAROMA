{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport invariant from 'invariant';\nimport styleObjectFunction from './util/styleObjectFunction';\nimport accumulateFunction from './util/accumulateFunction';\nimport getElementHTML from './util/getElementHTML';\nimport rangeSort from './util/rangeSort';\nimport defaultInlineHTML from './default/defaultInlineHTML';\nvar subtractStyles = function subtractStyles(original, toRemove) {\n  return original.filter(function (el) {\n    return !toRemove.some(function (elToRemove) {\n      return elToRemove.style === el.style;\n    });\n  });\n};\nvar popEndingStyles = function popEndingStyles(styleStack, endingStyles) {\n  return endingStyles.reduceRight(function (stack, style) {\n    var styleToRemove = stack[stack.length - 1];\n    invariant(styleToRemove.style === style.style, \"Style \".concat(styleToRemove.style, \" to be removed doesn't match expected \").concat(style.style));\n    return stack.slice(0, -1);\n  }, styleStack);\n};\nvar characterStyles = function characterStyles(offset, ranges) {\n  return ranges.filter(function (range) {\n    return offset >= range.offset && offset < range.offset + range.length;\n  });\n};\nvar rangeIsSubset = function rangeIsSubset(firstRange, secondRange) {\n  // returns true if the second range is a subset of the first\n  var secondStartWithinFirst = firstRange.offset <= secondRange.offset;\n  var secondEndWithinFirst = firstRange.offset + firstRange.length >= secondRange.offset + secondRange.length;\n  return secondStartWithinFirst && secondEndWithinFirst;\n};\nvar latestStyleLast = function latestStyleLast(s1, s2) {\n  // make sure longer-lasting styles are added first\n  var s2endIndex = s2.offset + s2.length;\n  var s1endIndex = s1.offset + s1.length;\n  return s2endIndex - s1endIndex;\n};\nvar getStylesToReset = function getStylesToReset(remainingStyles, newStyles) {\n  var i = 0;\n  while (i < remainingStyles.length) {\n    if (newStyles.every(rangeIsSubset.bind(null, remainingStyles[i]))) {\n      i++;\n    } else {\n      return remainingStyles.slice(i);\n    }\n  }\n  return [];\n};\nvar appendStartMarkup = function appendStartMarkup(inlineHTML, string, styleRange) {\n  return string + getElementHTML(inlineHTML(styleRange.style)).start;\n};\nvar prependEndMarkup = function prependEndMarkup(inlineHTML, string, styleRange) {\n  return getElementHTML(inlineHTML(styleRange.style)).end + string;\n};\nvar defaultCustomInlineHTML = function defaultCustomInlineHTML(next) {\n  return function (style) {\n    return next(style);\n  };\n};\ndefaultCustomInlineHTML.__isMiddleware = true;\nexport default (function (rawBlock) {\n  var customInlineHTML = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultCustomInlineHTML;\n  invariant(rawBlock !== null && rawBlock !== undefined, 'Expected raw block to be non-null');\n  var inlineHTML;\n  if (customInlineHTML.__isMiddleware === true) {\n    inlineHTML = customInlineHTML(defaultInlineHTML);\n  } else {\n    inlineHTML = accumulateFunction(styleObjectFunction(customInlineHTML), styleObjectFunction(defaultInlineHTML));\n  }\n  var result = '';\n  var styleStack = [];\n  var sortedRanges = rawBlock.inlineStyleRanges.sort(rangeSort);\n  var originalTextArray = _toConsumableArray(rawBlock.text);\n  for (var i = 0; i < originalTextArray.length; i++) {\n    var styles = characterStyles(i, sortedRanges);\n    var endingStyles = subtractStyles(styleStack, styles);\n    var newStyles = subtractStyles(styles, styleStack);\n    var remainingStyles = subtractStyles(styleStack, endingStyles); // reset styles: look for any already existing styles that will need to\n    // end before styles that are being added on this character. to solve this\n    // close out those current tags and all nested children,\n    // then open new ones nested within the new styles.\n\n    var resetStyles = getStylesToReset(remainingStyles, newStyles);\n    var openingStyles = resetStyles.concat(newStyles).sort(latestStyleLast);\n    var openingStyleTags = openingStyles.reduce(appendStartMarkup.bind(null, inlineHTML), '');\n    var endingStyleTags = endingStyles.concat(resetStyles).reduce(prependEndMarkup.bind(null, inlineHTML), '');\n    result += endingStyleTags + openingStyleTags + originalTextArray[i];\n    styleStack = popEndingStyles(styleStack, resetStyles.concat(endingStyles));\n    styleStack = styleStack.concat(openingStyles);\n    invariant(styleStack.length === styles.length, \"Character \".concat(i, \": \").concat(styleStack.length - styles.length, \" styles left on stack that should no longer be there\"));\n  }\n  result = styleStack.reduceRight(function (res, openStyle) {\n    return res + getElementHTML(inlineHTML(openStyle.style)).end;\n  }, result);\n  return result;\n});","map":{"version":3,"names":["_toConsumableArray","invariant","styleObjectFunction","accumulateFunction","getElementHTML","rangeSort","defaultInlineHTML","subtractStyles","original","toRemove","filter","el","some","elToRemove","style","popEndingStyles","styleStack","endingStyles","reduceRight","stack","styleToRemove","length","concat","slice","characterStyles","offset","ranges","range","rangeIsSubset","firstRange","secondRange","secondStartWithinFirst","secondEndWithinFirst","latestStyleLast","s1","s2","s2endIndex","s1endIndex","getStylesToReset","remainingStyles","newStyles","i","every","bind","appendStartMarkup","inlineHTML","string","styleRange","start","prependEndMarkup","end","defaultCustomInlineHTML","next","__isMiddleware","rawBlock","customInlineHTML","arguments","undefined","result","sortedRanges","inlineStyleRanges","sort","originalTextArray","text","styles","resetStyles","openingStyles","openingStyleTags","reduce","endingStyleTags","res","openStyle"],"sources":["/workspaces/Backwoodaroma/node_modules/draft-convert/esm/blockInlineStyles.js"],"sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport invariant from 'invariant';\nimport styleObjectFunction from './util/styleObjectFunction';\nimport accumulateFunction from './util/accumulateFunction';\nimport getElementHTML from './util/getElementHTML';\nimport rangeSort from './util/rangeSort';\nimport defaultInlineHTML from './default/defaultInlineHTML';\n\nvar subtractStyles = function subtractStyles(original, toRemove) {\n  return original.filter(function (el) {\n    return !toRemove.some(function (elToRemove) {\n      return elToRemove.style === el.style;\n    });\n  });\n};\n\nvar popEndingStyles = function popEndingStyles(styleStack, endingStyles) {\n  return endingStyles.reduceRight(function (stack, style) {\n    var styleToRemove = stack[stack.length - 1];\n    invariant(styleToRemove.style === style.style, \"Style \".concat(styleToRemove.style, \" to be removed doesn't match expected \").concat(style.style));\n    return stack.slice(0, -1);\n  }, styleStack);\n};\n\nvar characterStyles = function characterStyles(offset, ranges) {\n  return ranges.filter(function (range) {\n    return offset >= range.offset && offset < range.offset + range.length;\n  });\n};\n\nvar rangeIsSubset = function rangeIsSubset(firstRange, secondRange) {\n  // returns true if the second range is a subset of the first\n  var secondStartWithinFirst = firstRange.offset <= secondRange.offset;\n  var secondEndWithinFirst = firstRange.offset + firstRange.length >= secondRange.offset + secondRange.length;\n  return secondStartWithinFirst && secondEndWithinFirst;\n};\n\nvar latestStyleLast = function latestStyleLast(s1, s2) {\n  // make sure longer-lasting styles are added first\n  var s2endIndex = s2.offset + s2.length;\n  var s1endIndex = s1.offset + s1.length;\n  return s2endIndex - s1endIndex;\n};\n\nvar getStylesToReset = function getStylesToReset(remainingStyles, newStyles) {\n  var i = 0;\n\n  while (i < remainingStyles.length) {\n    if (newStyles.every(rangeIsSubset.bind(null, remainingStyles[i]))) {\n      i++;\n    } else {\n      return remainingStyles.slice(i);\n    }\n  }\n\n  return [];\n};\n\nvar appendStartMarkup = function appendStartMarkup(inlineHTML, string, styleRange) {\n  return string + getElementHTML(inlineHTML(styleRange.style)).start;\n};\n\nvar prependEndMarkup = function prependEndMarkup(inlineHTML, string, styleRange) {\n  return getElementHTML(inlineHTML(styleRange.style)).end + string;\n};\n\nvar defaultCustomInlineHTML = function defaultCustomInlineHTML(next) {\n  return function (style) {\n    return next(style);\n  };\n};\n\ndefaultCustomInlineHTML.__isMiddleware = true;\nexport default (function (rawBlock) {\n  var customInlineHTML = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultCustomInlineHTML;\n  invariant(rawBlock !== null && rawBlock !== undefined, 'Expected raw block to be non-null');\n  var inlineHTML;\n\n  if (customInlineHTML.__isMiddleware === true) {\n    inlineHTML = customInlineHTML(defaultInlineHTML);\n  } else {\n    inlineHTML = accumulateFunction(styleObjectFunction(customInlineHTML), styleObjectFunction(defaultInlineHTML));\n  }\n\n  var result = '';\n  var styleStack = [];\n  var sortedRanges = rawBlock.inlineStyleRanges.sort(rangeSort);\n\n  var originalTextArray = _toConsumableArray(rawBlock.text);\n\n  for (var i = 0; i < originalTextArray.length; i++) {\n    var styles = characterStyles(i, sortedRanges);\n    var endingStyles = subtractStyles(styleStack, styles);\n    var newStyles = subtractStyles(styles, styleStack);\n    var remainingStyles = subtractStyles(styleStack, endingStyles); // reset styles: look for any already existing styles that will need to\n    // end before styles that are being added on this character. to solve this\n    // close out those current tags and all nested children,\n    // then open new ones nested within the new styles.\n\n    var resetStyles = getStylesToReset(remainingStyles, newStyles);\n    var openingStyles = resetStyles.concat(newStyles).sort(latestStyleLast);\n    var openingStyleTags = openingStyles.reduce(appendStartMarkup.bind(null, inlineHTML), '');\n    var endingStyleTags = endingStyles.concat(resetStyles).reduce(prependEndMarkup.bind(null, inlineHTML), '');\n    result += endingStyleTags + openingStyleTags + originalTextArray[i];\n    styleStack = popEndingStyles(styleStack, resetStyles.concat(endingStyles));\n    styleStack = styleStack.concat(openingStyles);\n    invariant(styleStack.length === styles.length, \"Character \".concat(i, \": \").concat(styleStack.length - styles.length, \" styles left on stack that should no longer be there\"));\n  }\n\n  result = styleStack.reduceRight(function (res, openStyle) {\n    return res + getElementHTML(inlineHTML(openStyle.style)).end;\n  }, result);\n  return result;\n});"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}